<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jquery源码分析 | 前端学习笔记</title>
    <meta name="description" content="前端学习中的一些笔记及总结">
    <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/front-end-study/assets/css/0.styles.32c38af2.css" as="style"><link rel="preload" href="/front-end-study/assets/js/app.8d50f10d.js" as="script"><link rel="preload" href="/front-end-study/assets/js/2.8d937a8c.js" as="script"><link rel="preload" href="/front-end-study/assets/js/19.f7a3a423.js" as="script"><link rel="prefetch" href="/front-end-study/assets/js/10.f52eda7c.js"><link rel="prefetch" href="/front-end-study/assets/js/11.2a207987.js"><link rel="prefetch" href="/front-end-study/assets/js/12.01aa28b7.js"><link rel="prefetch" href="/front-end-study/assets/js/13.4527883c.js"><link rel="prefetch" href="/front-end-study/assets/js/14.c3b7450d.js"><link rel="prefetch" href="/front-end-study/assets/js/15.d4d389ff.js"><link rel="prefetch" href="/front-end-study/assets/js/16.a3638bd2.js"><link rel="prefetch" href="/front-end-study/assets/js/17.54f21fd6.js"><link rel="prefetch" href="/front-end-study/assets/js/18.3eb8d134.js"><link rel="prefetch" href="/front-end-study/assets/js/20.79486553.js"><link rel="prefetch" href="/front-end-study/assets/js/21.978f0a17.js"><link rel="prefetch" href="/front-end-study/assets/js/22.6223d7e6.js"><link rel="prefetch" href="/front-end-study/assets/js/23.08148677.js"><link rel="prefetch" href="/front-end-study/assets/js/24.4b066b56.js"><link rel="prefetch" href="/front-end-study/assets/js/25.afa98a0a.js"><link rel="prefetch" href="/front-end-study/assets/js/26.1dd01e6e.js"><link rel="prefetch" href="/front-end-study/assets/js/27.87c9010a.js"><link rel="prefetch" href="/front-end-study/assets/js/3.6cf61e10.js"><link rel="prefetch" href="/front-end-study/assets/js/4.b1577da0.js"><link rel="prefetch" href="/front-end-study/assets/js/5.bdaf13af.js"><link rel="prefetch" href="/front-end-study/assets/js/6.f4717c6c.js"><link rel="prefetch" href="/front-end-study/assets/js/7.996d1dce.js"><link rel="prefetch" href="/front-end-study/assets/js/8.203521e2.js"><link rel="prefetch" href="/front-end-study/assets/js/9.0a94c988.js">
    <link rel="stylesheet" href="/front-end-study/assets/css/0.styles.32c38af2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-end-study/" class="home-link router-link-active"><!----> <span class="site-name">前端学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-study/guide/" class="nav-link router-link-exact-active router-link-active">高级前端开发课程</a></div><div class="nav-item"><a href="/front-end-study/config/" class="nav-link">实际项目中的错误汇总</a></div><div class="nav-item"><a href="https://www.vuepress.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-study/guide/" class="nav-link router-link-exact-active router-link-active">高级前端开发课程</a></div><div class="nav-item"><a href="/front-end-study/config/" class="nav-link">实际项目中的错误汇总</a></div><div class="nav-item"><a href="https://www.vuepress.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>javascript进阶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-study/guide/" class="active sidebar-link">Jquery</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-study/guide/#jquery整体架构" class="sidebar-link">Jquery整体架构</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#jquery选择器" class="sidebar-link">Jquery选择器</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#callbacks入门与实践应用" class="sidebar-link">callbacks入门与实践应用</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#deferred概念-or-源码解析" class="sidebar-link">deferred概念 or 源码解析</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#时间绑定bind-delegate-on" class="sidebar-link">时间绑定bind/delegate/on</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#事件体系绑定，体系结构-绑定设计" class="sidebar-link">事件体系绑定，体系结构/绑定设计</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#自定义事件" class="sidebar-link">自定义事件</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#dom操作方法：html-text-css" class="sidebar-link">DOM操作方法：html-text-css;</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#样式操作css-addclass" class="sidebar-link">样式操作css/addClass</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#动画队列——动画设计——动画实现" class="sidebar-link">动画队列——动画设计——动画实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-study/guide/#_1-queue队列操作" class="sidebar-link">1.queue队列操作</a></li><li class="sidebar-sub-header"><a href="/front-end-study/guide/#_2-animate定义与用法：" class="sidebar-link">2.animate定义与用法：</a></li></ul></li></ul></li><li><a href="/front-end-study/guide/underscore.html" class="sidebar-link">underscore</a></li><li><a href="/front-end-study/guide/module.html" class="sidebar-link">module</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>单页应用专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5移动端开发</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node开发导学</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jquery源码分析"><a href="#jquery源码分析" class="header-anchor">#</a> Jquery源码分析</h1> <h2 id="jquery整体架构"><a href="#jquery整体架构" class="header-anchor">#</a> Jquery整体架构</h2> <p>$是jquery的别称。$()就是在创建jQuery的实例对象；
jQuery的共享原型模式：将jquery的原型对象上的init方法的原型对象指向jQuery的原型对象；即：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>jQuery<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
</code></pre></div><h2 id="jquery选择器"><a href="#jquery选择器" class="header-anchor">#</a> Jquery选择器</h2> <p>DOM对象：是由宿主环境提供的对象，在文档对象模型中，每个部分都是节点。如：所有HTML元素是元素节点，而element对象表示HTML元素。HTML DOM Element对象可以拥有类型为：元素节点，文本节点，注释节点的子节点。</p> <p>jQuery对象：jQuery构造函数创建出来的对象，通过jQuery选择器可以获取HTML的元素，并且以一种类数组的形式存储在jQuery对象中。</p> <p>element对象转化为jQuery对象：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> $obj <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>domObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>jquery对象转化为element对象：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> box <span class="token operator">=</span> $box<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>常用的jquery选择器接口：$()：</p> <ul><li>传入对象，如this等，把传入的对象包装成jQuery对象，</li> <li>传入函数,立即执行函数，相当于在DOM加载完毕后执行了<code>$(document).ready()</code>方法。</li> <li>传入字符串，查询DOM节点包装成jQuery对象；</li> <li>传入HTML字符串，创建DOM节点包装成jquery对象，</li> <li>空，则创建jQuery对象；</li></ul> <h2 id="callbacks入门与实践应用"><a href="#callbacks入门与实践应用" class="header-anchor">#</a> callbacks入门与实践应用</h2> <p>$.Callbacks用于管理函数队列。
通过add添加处理函数到队列中，通过fire去执行这些处理函数。<br>
$.Callbacks是在jquery内部使用的，如.ajax,$Deferred等组件提供基础功能的函数。它也可以用在类似功能的一些组件中，如自己开发的插件。<br> <strong>API</strong>：通过$.Callbacks，获取到一个Callbacks实例。add向内部队列添加函数，fire依次执行队列里的函数。<br>
$.Callbacks通过字符串参数的形式，支持4种的特定功能。</p> <ul><li>once：函数队列中的函数只执行一次；</li> <li>unique：往内部队列添加的函数保持唯一，不能重复添加。</li> <li>stopOnFalse：内部队列里的函数是依次执行的，当某个函数的返回值是false时，停止继续执行剩下的函数。</li> <li>memory：当函数队列fire一次过后，内部会记录当前fire的参数，当下次调用add的时候，会把记录的参数传递给新添加的函数并立即执行这个新添加的函数。<br> <code>toString.call()</code>;方法可以进行数据类型检测。<br> <code>split（）</code>，用于把字符串分割为数组，传参是一个正则表达式，以匹配到的那个字符进行分割；</li></ul> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>fireWith中调用fire(args)为啥不会执行到self中的fire？<br>
关于函数调用，有些地方需要function（options）{}，这种方式传入，有些地方又没有传，function(){},这种调用，然后通过arguments获得参数，有啥区别？</p></div> <h2 id="deferred概念-or-源码解析"><a href="#deferred概念-or-源码解析" class="header-anchor">#</a> deferred概念 or 源码解析</h2> <p>Promise/A+规范 or Deferred；
Promise作为一个模型，提供了一个在软件工程中描述延时（或将来）概念的解决方案；而Derferred是这种规范的具体实现。</p> <ul><li>Promise表示一个异步操作的最终结果。</li> <li>与Promise最主要的交互方法是，通过将函数传入它的then方法，从而获取得Promise最终的值或Promise最终拒绝（reject）的原因。</li> <li>一个Promise必须处于以下状态的其中之一：pending，fulfilled或rejected。</li> <li>一个Promise必须提供一个then方法来获取其值或原因。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>this指的是函数执行的环境，1.作为函数调用，2.对象的方法调用，3、构造函数使用，4、call、apply中使用。<br>
apply、call是Function的prototype上的函数，<code>fn.call();fn.apply()</code>都是调用函数，可以改变内部this的指向。<br>
call传参的时候是一一对应的，apply是传数组的，然后数组的下标一一对应参数。</p></div> <h2 id="时间绑定bind-delegate-on"><a href="#时间绑定bind-delegate-on" class="header-anchor">#</a> 时间绑定bind/delegate/on</h2> <p>DOM事件模型：<br> <strong>0级事件</strong>：通过JavaScript指定事件处理程序的传统方式，就是将一个函数赋值给一个事件处理程序属性。<br> <strong>2级事件</strong>：2级DOM中增加定义了DOM事件模型的概念，DOM2级事件规定的时间流包括3个阶段：事件捕获阶段，处于目标阶段和事件冒泡阶段，首先的是时间捕获，然后处于目标阶段，最后才是事件冒泡。<br> <strong>事件委托</strong>：利用事件冒泡，只指定一个事件处理程序来管理某一类型的所有事件。委托父级元素代理执行子元素的事件。<br> <strong>bind()</strong>：为被选元素添加一个或多个事件处理程序，并规定事件发生时运行的函数；<br> <strong>Delegate()</strong>:为被选元素的子元素，添加一个或多个事件处理程序。并规定当这些事件发生时运行的函数。
<strong>On()</strong>：在被选元素及子元素上添加一个或多个事件处理程序。</p> <h2 id="事件体系绑定，体系结构-绑定设计"><a href="#事件体系绑定，体系结构-绑定设计" class="header-anchor">#</a> 事件体系绑定，体系结构/绑定设计</h2> <p><strong>on方法源码分析，事件绑定原型设计</strong>。<br>
jQuery事件设计原型：jQuery并没有将事件处理函数直接绑定在DOM元素上，而是通过<code>jQuery.event.add</code>存储在cahce缓存对象上，最后在DOM元素上通过<code>addEventListener/attachEvent</code>绑定事件，当事件触发时，eventHandle被执行，eventHandle再去$.cache中寻找曾经绑定的事件处理函数并执行，对应jQuery中event对象上的jQuery.Event.add（给选中元素注册事件处理程序）、<code>jQuery.Event.dispatch（执行事件处理程序）</code>、<code>jQuery.Event.fix(event兼容性处理)</code>、<code>jQuery.Event.handlers（事件处理器队列）</code>；</p> <h2 id="自定义事件"><a href="#自定义事件" class="header-anchor">#</a> 自定义事件</h2> <p>jQuery事件以及JavaScript事件不能满足开发需求，就需要自己编写相应的事件，</p> <ul><li>添加自定义事件：通过jQuery的bind或者on方法添加自定义事件，</li> <li>触发自定义事件：通过jQuery的trigger方法触发自定义事件，</li> <li>trigger方法触发事件后，会执行浏览器的默认行为。如：聚焦；</li></ul> <h2 id="dom操作方法：html-text-css"><a href="#dom操作方法：html-text-css" class="header-anchor">#</a> DOM操作方法：html-text-css;</h2> <p>html-text-css作用：</p> <ul><li>html用来读取和修改元素的标签；</li> <li>text用来读取修改元素的纯文本内容；</li> <li>css用来设置或返回被选元素的一个或多个样式属性。三个方法都是通过jquery.access提供底层支持，jQuery.access;</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>让局部作用域的变量不销毁的方法：让一个全局变量拿到一个函数内部返回对象的引用。</p></div> <h2 id="样式操作css-addclass"><a href="#样式操作css-addclass" class="header-anchor">#</a> 样式操作css/addClass</h2> <p><strong>样式规则</strong>：内部属性名采用的是驼峰命名，保留关键字float环城CSSFloat，合并cssText;<br> <strong>样式访问</strong>：getComputedStyle改方法返回包含元素的所有属性值得对象;<br> <strong>Css()源码</strong>：style只能访问到行内style定义的属性。<br> <strong>addclass（）</strong>:对元素添加一个或者多个class。<br> <strong>DomManip</strong>:元老级工具函数，最主要功能是为了实现dom的插入和替换，主要是以下五个函数：append()在结尾插入。
Prepend()在元素开始地方插入。Before()跟after相反，在元素前面插入内容；after()在被选元素之后插入内容。replaceWith()替换元素；<br> <strong>domMainp实现</strong>：domManip完成两件事：1、DOM节点添加，2、检测DOM节点内有script标签。特殊处理。
<strong>domManip内对script做的特殊处理</strong>：</p> <ul><li>script无type属性，默认会执行其内的JavaScript脚本。</li> <li>script如果有src属性，会调用<code>$._evelUrl</code>请求JavaScript文件并执行。</li> <li>script的<code>type=&quot;text/javascript&quot;</code>会执行其内的JavaScript脚本，其他不会执行。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>domManip依赖的一个重要函数就是bulidFragment，为DOM插入提高性能。
buildFrag作用：这个方法用来构建一个包含子节点fragment对象，主要在DOMManip和<code>jQuery.parseHTML</code>中使用。</p></div> <h2 id="动画队列——动画设计——动画实现"><a href="#动画队列——动画设计——动画实现" class="header-anchor">#</a> 动画队列——动画设计——动画实现</h2> <h3 id="_1-queue队列操作"><a href="#_1-queue队列操作" class="header-anchor">#</a> 1.queue队列操作</h3> <p><strong>queue队列</strong>：与data数据缓存，deferred异步模型一样，是jquery库的内部实现的基础设施，也是animate动画依赖的基础设施。<br>
队列是一种特殊的线性表，只允许在表的前端（队头）进行删除操作（出队），在表的后端（队尾）进行插入操作（入队）。队列的特点是先进先出，即先进入先被删除。</p> <p><strong>Queue/dequeque</strong> ：</p> <ul><li><strong>queue</strong> ：传三个参数则是入队操作，第一个参数是绑定的元素，第二个是队列的别名，第三个是处理函数。传两个参数则是出队操作，第一个是元素，第二个是队列的别名。</li> <li><strong>Dequeue</strong> ：传入两个参数，第一个参数绑定的元素，第二个是队列名。每次通过dequeue调用，会执行第一个处理函数，并将已经执行了的第一个函数从队列中删除。dequeue可以通过在处理函数上添加next参数进行调用队列中的下一个处理函数。next是jQuery上的dequeue的一个引用。</li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>队列上锁的操作：“inprogress”<br>
在jQuery的实例对象上基于jQuery上的queue和dequeue扩展了同样名字的两个方法。</p></div> <h3 id="_2-animate定义与用法："><a href="#_2-animate定义与用法：" class="header-anchor">#</a> 2.animate定义与用法：</h3> <p>animate方法执行css属性集的自定义动画。该方法通过过css样式将元素从一个状态改变为另一个状态、css属性值数逐渐改变的，这样就可以创建动画效果。<br>
animate的几个语法:<br>
1.语法一：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>styles<span class="token punctuation">}</span><span class="token punctuation">,</span>speed<span class="token punctuation">,</span>easing <span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>1)styles:必需。规定产生动画效果的一个或多个css属性。</li> <li>2）speed，可选。规定动画速度；</li> <li>3）easing，可选，规定动画的不同点中元素的速度，默认值是“swing”。</li> <li>4）callback ，可选，animate执行后要执行的函数。</li></ul></div> <p>2.语法二：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>style<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>1）styles 必需，与一中一致；</li> <li>2）options：可选，规定动画的额外选项。可能值：speed easing callback step queue（布尔值）</li></ul></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/front-end-study/guide/underscore.html">underscore</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/front-end-study/assets/js/app.8d50f10d.js" defer></script><script src="/front-end-study/assets/js/2.8d937a8c.js" defer></script><script src="/front-end-study/assets/js/19.f7a3a423.js" defer></script>
  </body>
</html>
