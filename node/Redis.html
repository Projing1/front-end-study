<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis入门与应用 | 前端学习笔记</title>
    <meta name="description" content="前端学习中的一些笔记及总结">
    <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/front-end-study/assets/css/0.styles.32c38af2.css" as="style"><link rel="preload" href="/front-end-study/assets/js/app.8d50f10d.js" as="script"><link rel="preload" href="/front-end-study/assets/js/2.8d937a8c.js" as="script"><link rel="preload" href="/front-end-study/assets/js/25.afa98a0a.js" as="script"><link rel="prefetch" href="/front-end-study/assets/js/10.f52eda7c.js"><link rel="prefetch" href="/front-end-study/assets/js/11.2a207987.js"><link rel="prefetch" href="/front-end-study/assets/js/12.01aa28b7.js"><link rel="prefetch" href="/front-end-study/assets/js/13.4527883c.js"><link rel="prefetch" href="/front-end-study/assets/js/14.c3b7450d.js"><link rel="prefetch" href="/front-end-study/assets/js/15.d4d389ff.js"><link rel="prefetch" href="/front-end-study/assets/js/16.a3638bd2.js"><link rel="prefetch" href="/front-end-study/assets/js/17.54f21fd6.js"><link rel="prefetch" href="/front-end-study/assets/js/18.3eb8d134.js"><link rel="prefetch" href="/front-end-study/assets/js/19.f7a3a423.js"><link rel="prefetch" href="/front-end-study/assets/js/20.79486553.js"><link rel="prefetch" href="/front-end-study/assets/js/21.978f0a17.js"><link rel="prefetch" href="/front-end-study/assets/js/22.6223d7e6.js"><link rel="prefetch" href="/front-end-study/assets/js/23.08148677.js"><link rel="prefetch" href="/front-end-study/assets/js/24.4b066b56.js"><link rel="prefetch" href="/front-end-study/assets/js/26.1dd01e6e.js"><link rel="prefetch" href="/front-end-study/assets/js/27.87c9010a.js"><link rel="prefetch" href="/front-end-study/assets/js/3.6cf61e10.js"><link rel="prefetch" href="/front-end-study/assets/js/4.b1577da0.js"><link rel="prefetch" href="/front-end-study/assets/js/5.bdaf13af.js"><link rel="prefetch" href="/front-end-study/assets/js/6.f4717c6c.js"><link rel="prefetch" href="/front-end-study/assets/js/7.996d1dce.js"><link rel="prefetch" href="/front-end-study/assets/js/8.203521e2.js"><link rel="prefetch" href="/front-end-study/assets/js/9.0a94c988.js">
    <link rel="stylesheet" href="/front-end-study/assets/css/0.styles.32c38af2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-end-study/" class="home-link router-link-active"><!----> <span class="site-name">前端学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-study/guide/" class="nav-link">高级前端开发课程</a></div><div class="nav-item"><a href="/front-end-study/config/" class="nav-link">实际项目中的错误汇总</a></div><div class="nav-item"><a href="https://www.vuepress.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-study/guide/" class="nav-link">高级前端开发课程</a></div><div class="nav-item"><a href="/front-end-study/config/" class="nav-link">实际项目中的错误汇总</a></div><div class="nav-item"><a href="https://www.vuepress.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>javascript进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>单页应用专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5移动端开发</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Node开发导学</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-study/node/ES6.html" class="sidebar-link">ES6快速入门</a></li><li><a href="/front-end-study/node/Node.html" class="sidebar-link">nodejs静态服务器搭建</a></li><li><a href="/front-end-study/node/Linux.html" class="sidebar-link">Linux快速上手</a></li><li><a href="/front-end-study/node/Nginx.html" class="sidebar-link">Nginx入门</a></li><li><a href="/front-end-study/node/Redis.html" class="active sidebar-link">Redis入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-study/node/Redis.html#redis简介" class="sidebar-link">Redis简介</a></li><li class="sidebar-sub-header"><a href="/front-end-study/node/Redis.html#redis安装及配置" class="sidebar-link">Redis安装及配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-study/node/Redis.html#安装redis" class="sidebar-link">安装Redis</a></li><li class="sidebar-sub-header"><a href="/front-end-study/node/Redis.html#配置文件" class="sidebar-link">配置文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/front-end-study/node/Redis.html#redis数据结构及应用" class="sidebar-link">Redis数据结构及应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-study/node/Redis.html#redis在node-js中的应用" class="sidebar-link">Redis在Node.js中的应用</a></li></ul></li></ul></li><li><a href="/front-end-study/node/communication.html" class="sidebar-link">通信协议详解</a></li><li><a href="/front-end-study/node/egg.html" class="sidebar-link">eggJs</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="redis入门与应用"><a href="#redis入门与应用" class="header-anchor">#</a> Redis入门与应用</h1> <h2 id="redis简介"><a href="#redis简介" class="header-anchor">#</a> Redis简介</h2> <p>Redis是一个远程内存数据库，它不仅性能强，而且还具有复制特性以及为解决问题而生的独一无二的数据模型。</p> <p>Redis是一个速度非常快的非关系型数据库，它可以存储键和5种不同类型值的之间的映射，可以将存储在内存中的键值对数据持久化到硬盘，可以使用复制特性来扩展读性能，又可以使用客户端分片来扩展写性能。</p> <blockquote><p>分片是一种将数据划分为多个部分的方法，对数据的划分可以基于键包含的ID、基于键的散列值，或者基于两者的某种组合。通过对数据进行分片，用户可以将数据存储到多台机器里，也可以从多台机器里面获取数据，这种方法在解决某些问题是可以获得线程级别的性能提升。</p></blockquote> <ul><li>Redis与其它软件对比</li></ul> <table><thead><tr><th style="text-align:center;">名称</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">数据存储</th> <th style="text-align:left;">数据查询</th></tr></thead> <tbody><tr><td style="text-align:center;">Redis</td> <td style="text-align:left;">使用内存存储的非关系型数据库</td> <td style="text-align:left;">字符串、列表、集合、散列表、有序集合</td> <td style="text-align:left;">每种数据类型都有自己的命令</td></tr> <tr><td style="text-align:center;">memcached</td> <td style="text-align:left;">使用内存存储的键值缓存</td> <td style="text-align:left;">键值之间的映射</td> <td style="text-align:left;">创建、读取、更新、删除等</td></tr> <tr><td style="text-align:center;">MySQL</td> <td style="text-align:left;">关系型数据库</td> <td style="text-align:left;">每个数据库包含多个表，每个表包含多行</td> <td style="text-align:left;">select、insert、update、delete等</td></tr> <tr><td style="text-align:center;">MongoDB</td> <td style="text-align:left;">使用硬盘存储的非关系型数据库</td> <td style="text-align:left;">每个数据库包含多个表，每个表包含多个BSON文档</td> <td style="text-align:left;">创建、读取、更新、删除等</td></tr></tbody></table> <ul><li><p>Redis 数据持久化</p> <p>Redis拥有两种不同形式的持久化方法，它们都可以用小而 紧凑的格式将存储在内存中的数据写入硬盘</p> <ul><li><p>时间点转储</p> <blockquote><p>可以在“指定时间段内有指定数量的写操作”条件被满足时执行，又可以通过调用两条转储命令来执行</p></blockquote></li> <li><p>将所有修改了数据库的命令都追加到一个文件里</p></li></ul></li></ul> <h2 id="redis安装及配置"><a href="#redis安装及配置" class="header-anchor">#</a> Redis安装及配置</h2> <h3 id="安装redis"><a href="#安装redis" class="header-anchor">#</a> 安装Redis</h3> <ol><li><p>下载安装包</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">wget</span> http://download.redis.io/releases/redis-5.0.8.tar.gz <span class="token comment"># 上课前记得下好</span>
</code></pre></div></li> <li><p>解压安装包</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">tar</span> -zxvf redis-5.0.8.tar.gz <span class="token comment"># 解压</span>
</code></pre></div></li> <li><p>安装gcc依赖</p> <div class="language-shell extra-class"><pre class="language-shell"><code>yum <span class="token function">install</span> -y gcc
</code></pre></div></li> <li><p>编译</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> redis-5.0.8
<span class="token function">make</span> <span class="token assign-left variable">MALLOC</span><span class="token operator">=</span>libc <span class="token comment"># 配置分配器allocator,MALLOC环境变量的值为libc</span>
</code></pre></div></li> <li><p>编译安装</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> src <span class="token comment"># 进入src 目录</span>
<span class="token function">make</span> <span class="token function">install</span> <span class="token comment"># 编译安装</span>
</code></pre></div></li> <li><p>启动Redis服务</p> <ul><li><p>直接启动</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> /usr/local/bin    <span class="token comment"># 默认安装目录</span>
./redis-server			<span class="token comment"># 直接启动服务</span>

<span class="token comment"># 也可以不用进入目录，因为该目录本来就处于path中</span>
redis-server
</code></pre></div></li> <li><p>后台进程方式启动</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mv</span> /tmp/redis-5.0.8/redis.conf /etc/redis.conf  <span class="token comment"># 设置配置文件</span>
<span class="token function">vim</span> /etc/redis.conf  
<span class="token comment"># daemonize no 改成yes</span>
<span class="token comment"># 设置允许后台运行</span>

<span class="token comment"># 启动并加载配置文件</span>
redis-server /etc/redis.conf

<span class="token comment"># 关闭 </span>
<span class="token comment"># 使用kill 命令杀死进程</span>
<span class="token function">ps</span> -ef<span class="token operator">|</span><span class="token function">grep</span> redis-server
<span class="token function">kill</span> -9 xxxx

</code></pre></div></li> <li><p>系统服务启动</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> /tmp/redis-5.0.8/utils
./install_server.sh     <span class="token comment"># 安装服务</span>

<span class="token function">service</span> redis_6379 start   <span class="token comment"># 启动服务</span>
<span class="token function">service</span> redis_6379 stop    <span class="token comment"># 停止服务</span>
<span class="token function">service</span> redis_6379 restart <span class="token comment"># 重启服务</span>
systemctl <span class="token builtin class-name">enable</span> redis_6379    <span class="token comment"># 开机自启动</span>
</code></pre></div></li></ul></li></ol> <h3 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">######################### 基础配置 ########################</span>
<span class="token comment"># 设置以daemon方式启动</span>
daemonize <span class="token function">yes</span>
<span class="token comment"># 设置日志文件路径</span>
logfile <span class="token string">&quot;/var/log/redis.log&quot;</span>
<span class="token comment"># 设置RDB或AOF文件的存放目录</span>
<span class="token function">dir</span> /data/redis
<span class="token comment"># 设置开启AOF持久化</span>
appendonly <span class="token function">yes</span>

<span class="token comment">######################## 安全配置 #########################</span>
<span class="token comment"># 允许指定的IP连接到Redis</span>
<span class="token builtin class-name">bind</span> <span class="token number">127.0</span>.0.1
<span class="token comment"># 设置监听端口，默认是6379</span>
port <span class="token number">16000</span>
<span class="token comment"># 设置Redis登录密码，通过 redis-cli -a &quot;123456&quot; 登录</span>
requirepass <span class="token number">123456</span>
<span class="token comment"># 将CONFIG命令重命名为CHANGE，在 Redis 中可以使用 CONFIG 命令来修改配置</span>
rename-command CONFIG CHANGE
<span class="token comment"># 禁用CONFIG命令，要么禁用要么重命名，只能配置其中一种</span>
rename-command CONFIG <span class="token string">&quot;&quot;</span>
</code></pre></div><h2 id="redis数据结构及应用"><a href="#redis数据结构及应用" class="header-anchor">#</a> Redis数据结构及应用</h2> <table><thead><tr><th style="text-align:center;">结构类型</th> <th>存储值</th> <th>读写能力</th></tr></thead> <tbody><tr><td style="text-align:center;">STRING</td> <td>可以是字符串、整数及浮点数</td> <td>对整个字符串或者字符串中一部分操作；对整数和浮点数执行increment或者decrement</td></tr> <tr><td style="text-align:center;">LIST</td> <td>链表，每个节点包含一个STRING</td> <td>从链表两端push或者pop元素；根据偏移量对链表进行裁剪；读取单个或多个元素；根据值查找或移除元素</td></tr> <tr><td style="text-align:center;">SET</td> <td>包含STRING的无序集合，其值具有唯一性</td> <td>添加、获取、移除单个元素；检查一个元素是否存在于集合中；</td></tr> <tr><td style="text-align:center;">HASH</td> <td>包含键值对的无序散列表</td> <td>添加、获取、移除单个键值对；获取所有键值对；</td></tr> <tr><td style="text-align:center;">ZSET</td> <td>STRING成员与浮点数分值之间的有序映射，排列顺序由分值大小决定</td> <td>添加、获取、移除单个元素；根据分值范围或者成员获取元素</td></tr></tbody></table> <ul><li><p>STRING</p> <table><thead><tr><th>命令</th> <th>行为</th></tr></thead> <tbody><tr><td>SET</td> <td>设置存储在给定键中的值</td></tr> <tr><td>GET</td> <td>获取存储在给定键中的值</td></tr> <tr><td>DEL</td> <td>删除存储在给定键中的值（可用于所有类型）</td></tr></tbody></table> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">set</span> hello world 			<span class="token comment"># OK</span>
get hello 						<span class="token comment"># &quot;world&quot;</span>
del hello 						<span class="token comment"># (integer) 1</span>
get hello							<span class="token comment"># (nil)</span>
</code></pre></div></li> <li><p>LIST</p> <table><thead><tr><th>命令</th> <th>行为</th></tr></thead> <tbody><tr><td>RPUSH</td> <td>将给定值推入列表右端</td></tr> <tr><td>LRANGE</td> <td>获取列表再给定范围上的所有值</td></tr> <tr><td>LINDEX</td> <td>获取列表再给定位置上的单个元素</td></tr> <tr><td>LPOP</td> <td>从列表左端弹出一个值，并返回弹出值</td></tr></tbody></table> <div class="language-shell extra-class"><pre class="language-shell"><code>rpush list item									<span class="token comment"># (integer) 1</span>
rpush list item2 item						<span class="token comment"># (integer) 3</span>
lrange list <span class="token number">0</span> -1								<span class="token comment"># &quot;item&quot; &quot;item2&quot; &quot;item&quot; </span>
lindex list <span class="token number">1</span>										<span class="token comment"># &quot;item2&quot;</span>
lpop list												<span class="token comment"># &quot;item&quot;</span>
lrange list <span class="token number">0</span> -1								<span class="token comment"># &quot;item2&quot; &quot;item&quot;</span>
</code></pre></div></li> <li><p>SET</p> <table><thead><tr><th>命令</th> <th>行为</th></tr></thead> <tbody><tr><td>SADD</td> <td>将给定元素添加到集合</td></tr> <tr><td>SMEMBERS</td> <td>返回集合包含的所有元素</td></tr> <tr><td>SISMEMBER</td> <td>检查给定元素是否存在于集合中</td></tr> <tr><td>SREM</td> <td>如果给定元素存在于集合中，就移除该元素</td></tr></tbody></table> <div class="language-shell extra-class"><pre class="language-shell"><code>sadd <span class="token builtin class-name">set</span> item					<span class="token comment"># (integer) 1</span>
sadd <span class="token builtin class-name">set</span> item2 item3	<span class="token comment"># (integer) 3</span>
sadd <span class="token builtin class-name">set</span> item					<span class="token comment"># (integer) 0</span>
smembers <span class="token builtin class-name">set</span>					<span class="token comment"># &quot;item&quot; &quot;item2&quot; &quot;item3&quot;</span>
sismember <span class="token builtin class-name">set</span> item		<span class="token comment"># (integer) 1</span>
sismember <span class="token builtin class-name">set</span> item4		<span class="token comment"># (integer) 0</span>
srem <span class="token builtin class-name">set</span> item2				<span class="token comment"># (integer) 1</span>
srem <span class="token builtin class-name">set</span> item2				<span class="token comment"># (integer) 0</span>
</code></pre></div></li> <li><p>HASH</p> <table><thead><tr><th>命令</th> <th>行为</th></tr></thead> <tbody><tr><td>HSET</td> <td>再散列中关联起给定的键值对</td></tr> <tr><td>HGET</td> <td>获取指定散列键的值</td></tr> <tr><td>HGETALL</td> <td>获取散列包含的所有键值对</td></tr> <tr><td>HDEL</td> <td>如果给定键存在于散列，则移除</td></tr></tbody></table> <div class="language-shell extra-class"><pre class="language-shell"><code>hset <span class="token builtin class-name">hash</span> key1 value1							<span class="token comment"># (integer) 1</span>
hset <span class="token builtin class-name">hash</span> key2 value2							<span class="token comment"># (integer) 2</span>
hset <span class="token builtin class-name">hash</span> key1 value 							<span class="token comment"># (integer) 0</span>
hgetall <span class="token builtin class-name">hash</span>											<span class="token comment"># &quot;key1&quot; &quot;value1&quot; &quot;key2&quot; &quot;value2&quot;</span>
hdel <span class="token builtin class-name">hash</span> key2										<span class="token comment"># (integer) 1</span>
hget key1													<span class="token comment"># &quot;value1&quot;</span>
</code></pre></div></li> <li><p>ZSET</p> <table><thead><tr><th>命令</th> <th>行为</th></tr></thead> <tbody><tr><td>ZADD</td> <td>将一个带有给定分值的成员添加到有序集合中</td></tr> <tr><td>ZRANGE</td> <td>根据元素再有序集合所处位置，从有序集合获取多个元素</td></tr> <tr><td>ZRANGEBYSCORE</td> <td>获取有序集合再给定分值范围内的所有元素</td></tr> <tr><td>ZREM</td> <td>如果给定成员存在于有序集合，则删除</td></tr></tbody></table> <div class="language-shell extra-class"><pre class="language-shell"><code>zadd zset <span class="token number">728</span> member0				<span class="token comment"># (integer) 1</span>
zadd zset <span class="token number">982</span> member1				<span class="token comment"># (integer) 2</span>
zadd zset <span class="token number">982</span> member2				<span class="token comment"># (integer) 3</span>
zadd zset <span class="token number">666</span> member0				<span class="token comment"># (integer) 0,score更新为 666</span>
zrange zset <span class="token number">0</span> -1 withscores  <span class="token comment"># &quot;member0&quot; &quot;666&quot; &quot;member1&quot; &quot;982&quot; &quot;member2&quot; &quot;982&quot;</span>
zrangebyscore zset <span class="token number">700</span> <span class="token number">1000</span> withscores			<span class="token comment"># &quot;member1&quot; &quot;982&quot; &quot;member2&quot; &quot;982&quot;</span>
zrem zset member1						<span class="token comment"># (integer) 1</span>
</code></pre></div></li></ul> <h3 id="redis在node-js中的应用"><a href="#redis在node-js中的应用" class="header-anchor">#</a> Redis在Node.js中的应用</h3> <ul><li><p>Node.js连接Redis</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> redis -S
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> redis <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'redis'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>数据操作</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 字符串类型</span>

<span class="token keyword">var</span> res <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> <span class="token string">' data: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// err:  null  data:  OK，res的值是true</span>
 
client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>  <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> <span class="token string">' data: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">cb</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error:'</span><span class="token punctuation">,</span>err<span class="token punctuation">,</span><span class="token string">'data:'</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

client<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">incr</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">// 链表类型</span>

client<span class="token punctuation">.</span><span class="token function">rpush</span><span class="token punctuation">(</span><span class="token string">'friends'</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token string">'赵六'</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">lrange</span><span class="token punctuation">(</span><span class="token string">'friends'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 左侧推入</span>
client<span class="token punctuation">.</span><span class="token function">lpush</span><span class="token punctuation">(</span><span class="token string">'friends'</span><span class="token punctuation">,</span><span class="token string">'田七'</span><span class="token punctuation">,</span><span class="token string">'王八'</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">lrange</span><span class="token punctuation">(</span><span class="token string">'friends'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 右侧弹出</span>
<span class="token comment">// rpop lpop</span>
client<span class="token punctuation">.</span><span class="token function">lindex</span><span class="token punctuation">(</span><span class="token string">'friends'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 裁剪</span>
client<span class="token punctuation">.</span><span class="token function">ltrim</span><span class="token punctuation">(</span><span class="token string">'friends'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span> 
client<span class="token punctuation">.</span><span class="token function">lrange</span><span class="token punctuation">(</span><span class="token string">'friends'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 集合</span>

<span class="token comment">//往集合ids中加几个元素</span>
client<span class="token punctuation">.</span><span class="token function">sadd</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//err:  null  data:  2</span>
<span class="token comment">//查看集合元素</span>
client<span class="token punctuation">.</span><span class="token function">smembers</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  [ '1', '2' ]</span>
<span class="token comment">//从集合中删除元素</span>
client<span class="token punctuation">.</span><span class="token function">srem</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// err:  null  data:  1</span>
<span class="token comment">//看看发生了啥</span>
client<span class="token punctuation">.</span><span class="token function">smembers</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  [ '1' ]</span>
<span class="token comment">//看看集合有多少个元素</span>
client<span class="token punctuation">.</span><span class="token function">scard</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  1</span>
<span class="token comment">//再加几个元素进去</span>
client<span class="token punctuation">.</span><span class="token function">sadd</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
<span class="token comment">//判断元素是否在集合内</span>
client<span class="token punctuation">.</span><span class="token function">sismember</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// err:  null  data:  1</span>
client<span class="token punctuation">.</span><span class="token function">sismember</span><span class="token punctuation">(</span><span class="token string">'ids'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 散列</span>
<span class="token comment">//往散列上添加多组键值对</span>
client<span class="token punctuation">.</span><span class="token function">hmset</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token number">5888</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'iphonex'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  OK</span>
<span class="token comment">//查看多个键的值</span>
client<span class="token punctuation">.</span><span class="token function">hmget</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  [ '5888', 'iphonex' ]</span>
<span class="token comment">//查看键值对的数量</span>
client<span class="token punctuation">.</span><span class="token function">hlen</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  2</span>
<span class="token comment">//删掉其中一个键值对</span>
client<span class="token punctuation">.</span><span class="token function">hdel</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  1 </span>
<span class="token comment">//看看price是否还在？</span>
client<span class="token punctuation">.</span><span class="token function">hmget</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  [ null ]</span>
<span class="token comment">//再加几个属性</span>
client<span class="token punctuation">.</span><span class="token function">hmset</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> <span class="token string">'vendor'</span><span class="token punctuation">,</span> <span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'madein'</span><span class="token punctuation">,</span> <span class="token string">'china'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//取出所有的键值对</span>
client<span class="token punctuation">.</span><span class="token function">hgetall</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  { name: 'iphonex', vendor: 'apple', madein: 'china' }</span>
<span class="token comment">//取出所有的键</span>
client<span class="token punctuation">.</span><span class="token function">hkeys</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  [ 'name', 'vendor', 'madein' ] </span>
<span class="token comment">//取出所有的值</span>
client<span class="token punctuation">.</span><span class="token function">hvals</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  [ 'iphonex', 'apple', 'china' ]</span>
<span class="token comment">//判断键是否存在</span>
client<span class="token punctuation">.</span><span class="token function">hexists</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  1</span>
client<span class="token punctuation">.</span><span class="token function">hexists</span><span class="token punctuation">(</span><span class="token string">'phone'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//err:  null  data:  0</span>

</code></pre></div></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front-end-study/node/Nginx.html" class="prev">Nginx入门</a></span> <span class="next"><a href="/front-end-study/node/communication.html">通信协议详解</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/front-end-study/assets/js/app.8d50f10d.js" defer></script><script src="/front-end-study/assets/js/2.8d937a8c.js" defer></script><script src="/front-end-study/assets/js/25.afa98a0a.js" defer></script>
  </body>
</html>
